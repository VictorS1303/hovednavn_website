---
import {concertCardsData} from '../js/concert_maps_data'

const {
  class: className,
  id: id,
  src,
  showOverlay,
  isConcertCard,
  concertDate,
  concertLocation,
  concertPrice,
  isArtistCard,
  artistName,
  artistBandRole,
  concertLocationCoordinates,
} = Astro.props

import Overlay from './Overlay.astro'
import ConcertCardContent from './ConcertCardContent.astro'
import ArtistCardContent from './ArtistCardContent.astro'

// Find the matching concert data based on date and location (or other properties)
const matchingConcert = concertCardsData.find(
  (concert) =>
    concert.concertDate === concertDate &&
    concert.concertLocation === concertLocation,
)

const concertId = matchingConcert?.concertId || null // Default to null if not found
---

{
  isArtistCard ? (
    <a href={`/artist/${artistName}`} class='block'>
      {/* You can adjust the href as needed */}
      <article
        class={`${className} relative h-[325px] w-[300px] flex justify-center`}
        id={id}>
        <img src={src} class='h-full w-full object-cover' />
        {showOverlay && <Overlay />}

        {/* Only show ConcertCardContent if isConcertCard is true */}
        {isConcertCard && (
          <ConcertCardContent
            concertDate={concertDate}
            concertLocation={concertLocation}
            concertLocationCoordinates={concertLocationCoordinates}
          />
        )}

        {isArtistCard && (
          <ArtistCardContent
            artistName={artistName}
            artistBandRole={artistBandRole}
          />
        )}
      </article>
    </a>
  ) : (
    <article class={`${className} relative h-[325px] w-[300px]`} id={id}>
      <img src={src} class='h-full w-full object-cover' />
      {showOverlay && <Overlay />}

      {/* Only show ConcertCardContent if isConcertCard is true */}
      {isConcertCard && (
        <ConcertCardContent
          concertDate={concertDate}
          concertLocation={concertLocation}
          concertPrice={concertPrice}
          concertId={concertId}
        />
      )}

      {isArtistCard && (
        <ArtistCardContent
          artistName={artistName}
          artistBandRole={artistBandRole}
        />
      )}
    </article>
  )
}
